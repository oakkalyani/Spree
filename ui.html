<html>
    <head>
        <link rel="stylesheet" href="button_tag.css">
        <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
        <script>filename="redirect.js"</script>
        <meta charset="UTF-8">
        <title>spree</title>
        <h1 style="text-align:center"> Spree POC </h1>
        <button onclick="getCurTime()" type="button">Get current time position</button>
        <hr>
            

          <div id="container">
            <video id="video" controls autoplay loop>
              <source src="knives_out.mp4" type="video/mp4">
            </video>

            <div id="changeVideo">
                <button onclick="productLink()" id = "link_to_ext"> </button>
              </div>
            <div id="shoppingButton">
             <button onclick="turnOn()" id = "spreeButton">Spree</button>
            </div>
            <script>
              var state = false
              var cur_link = ""
              var cur_item = ""

              function getCurTime() {
                console.log(vid.currentTime)
              }

              function turnOn() {
                if (state === false)  {
                  document.getElementById("spreeButton").style.backgroundColor = 'green';
                  state = true;
                }
                else {
                  document.getElementById("spreeButton").style.backgroundColor = 'white';
                  state = false;
                }
              }

              var vid = document.getElementById("video");

              var red_coat_link = "https://www.amazon.com/MYS-Blazer-Button-Business-Wedding/dp/B07T96C7DY/ref=sr_1_3?dchild=1&keywords=red+suit&qid=1616551894&sr=8-3"
              var suit = "https://www.amazon.com/Stacy-Adams-Vested-Piece-Regular/dp/B00K17NNTC/ref=sr_1_4?dchild=1&keywords=black+suit&qid=1616551956&sr=8-4"
              var brown_sweater = "https://www.amazon.com/Pendleton-Shetland-Sweater-Brown-Harding/dp/B083B2YHK5/ref=sr_1_6?dchild=1&keywords=brown+sweater&qid=1616552002&sr=8-6"

              links_dict = {
                "red_coat_link": { "coord": [20, 400], "link": red_coat_link, "time": 0, "size": [400, 300], "clicked": 0},
                "suit": { "coord": [20, 400], "link": suit, "time": 0, "size": [400, 300], "clicked": 0},
                "brown_sweater": { "coord": [20, 480],  "link": brown_sweater, "time": 0, "size": [400, 300], "clicked": 0} 
              };

              vid.onmousemove = function(){
                var x = document.getElementById("changeVideo");
                
                if(vid.currentTime >= 10 && vid.currentTime <= 11 ) {
                  x.style.top = links_dict['red_coat_link']['coord'][0];
                  x.style.left = links_dict['red_coat_link']['coord'][1];

                  x.style.height = links_dict['red_coat_link']['size'][0];
                  x.style.width = links_dict['red_coat_link']['size'][1];

                  cur_link = links_dict['red_coat_link']['link'];
                  cur_item = 'red_coat_link'
                  
                  if (state == true) x.style.display = "block";
                  else x.style.display = "none";
                }
                else if(vid.currentTime == 37.220558) {
                  x.style.top = links_dict['suit']['coord'][0];
                  x.style.left = links_dict['suit']['coord'][1];

                  x.style.height = links_dict['suit']['size'][0];
                  x.style.width = links_dict['suit']['size'][1];

                  cur_link = links_dict['suit']['link'];
                  cur_item = 'suit'

                  if (state == true) x.style.display = "block";
                  else x.style.display = "none";
                }
                else if(vid.currentTime == 52.062109) {
                  x.style.top = links_dict['brown_sweater']['coord'][0];
                  x.style.left = links_dict['brown_sweater']['coord'][1];

                  x.style.height = links_dict['brown_sweater']['size'][0];
                  x.style.width = links_dict['brown_sweater']['size'][1];

                  cur_link = links_dict['brown_sweater']['link'];
                  cur_item = 'brown_sweater'

                  if (state == true && links_dict[cur_item]['clicked'] == 0) x.style.display = "block";
                  else x.style.display = "none";
                }
                else {
                  x.style.display = "none";
                }
              }

              function productLink() {
                links_dict[cur_item]['clicked'] = 1
                $('#video').trigger('pause');
                var win = window.open(cur_link, '_blank');
                win.focus();
              }
                </script>
          </div>          
    </head>
</html>
